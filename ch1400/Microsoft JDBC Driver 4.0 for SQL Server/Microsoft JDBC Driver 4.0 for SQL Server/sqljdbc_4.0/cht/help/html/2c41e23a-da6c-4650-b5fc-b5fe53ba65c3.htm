<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>了解隔離等級</title><meta name="Language" content="zh-cht" /><meta name="System.Keywords" content="交易隔離等級" /><meta name="Microsoft.Help.Id" content="2c41e23a-da6c-4650-b5fc-b5fe53ba65c3" /><meta name="Description" content="交易可指定隔離等級，以定義某個交易必須與其他交易所修改之資源或資料隔離的程度。隔離等級是以並行副作用來表示，例如，允許中途讀取或虛設項目讀取。" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">了解隔離等級</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>交易可指定隔離等級，以定義某個交易必須與其他交易所修改之資源或資料隔離的程度。隔離等級是以並行副作用來表示，例如，允許中途讀取或虛設項目讀取。</p><p>交易隔離等級可控制下列項目：</p><ul><li><p>在讀取資料時是否採用鎖定，以及要求哪一類型的鎖定。</p></li><li><p>保留讀取鎖定的時間長度。</p></li><li><p>讀取作業是否參考另一個交易修改的資料列：</p><ul><li><p>封鎖資料列上的獨佔鎖定直到釋放它為止。</p></li><li><p>擷取在啟動陳述式或交易時即存在的資料列認可版本。</p></li><li><p>讀取未認可的資料修改。</p></li></ul></li></ul><p>選擇交易隔離等級並不會影響為保護資料修改所取得的鎖定。交易永遠都會取得它所修改之任何資料的獨佔鎖定，並保留該鎖定直到交易完成為止，不論為該交易所設定的隔離等級為何皆同。對於讀取作業，交易隔離等級主要是定義對於其他交易所做修改之影響的保謢等級。</p><p>較低的隔離等級將可讓更多的使用者同時存取資料，但也會增加使用者可能遇到並行作用 (例如，中途讀取或遺失的更新) 的數目。相反地，較高的隔離等級將可減少使用者遇到並行作用的類型，但是將需要更多的系統資源，而且會增加一個交易封鎖另一個交易的可能性。選擇適當的隔離等級需視應用程式的資料完整性需求與每個隔離等級的負擔平衡而定。最高的隔離等級為可序列化，可確保每次交易重複讀取作業時都能擷取完全相同的資料，但它是透過執行鎖定層級來達成此目的，因此在多使用者系統中有可能會影響其他使用者。最低隔離等級為讀取未認可，可以擷取其他交易已修改但尚未認可的資料。在讀取未認可中可能會發生所有的並行副作用，但由於沒有讀取鎖定或版本控制，因此可將負擔降到最低。</p></div><h1 class="heading">備註</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>下表顯示不同隔離等級所允許的並行副作用。</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>隔離等級</p></th><th><p>中途讀取</p></th><th><p>不可重複讀取</p></th><th><p>虛設項目</p></th></tr><tr><td><p>讀取未認可</p></td><td><p>是</p></td><td><p>是</p></td><td><p>是</p></td></tr><tr><td><p>讀取認可</p></td><td><p>否</p></td><td><p>是</p></td><td><p>是</p></td></tr><tr><td><p>可重複讀取</p></td><td><p>否</p></td><td><p>否</p></td><td><p>是</p></td></tr><tr><td><p>快照</p></td><td><p>否</p></td><td><p>否</p></td><td><p>否</p></td></tr><tr><td><p>可序列化</p></td><td><p>否</p></td><td><p>否</p></td><td><p>否</p></td></tr></table></div><p>交易必須至少在可重複讀取的隔離等級執行，以防在兩個交易個別擷取相同的資料列，然後在稍後根據原始擷取的值更新資料列時可能發生的更新遺失。如果兩個交易都使用單一 UPDATE 陳述式更新資料列，而且沒有以先前擷取的值做為更新的基礎，就不會在讀取認可的預設隔離等級發生更新的遺失。</p><p>若要設定交易的隔離等級，您可以使用 <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> 類別的 <a href="6a8fa4d3-5237-40f8-8a02-b40a3d7a1131.htm">setTransactionIsolation</a> 方法。這個方法會根據下列其中一個連接常數，接受 <span sdata="langKeyword" value="int"><span class="keyword">int</span></span> 值做為其引數：</p><div class="sampleCode"><span codeLanguage="other"><pre>con.setTransactionIsolation(Connection.TRANSACTION_READ_COMMITTED);</pre></span></div><p>若要使用 SQL Server 的新快照隔離等級，您可以使用下列其中一個 <b>SQLServerConnection</b> 常數：</p><div class="sampleCode"><span codeLanguage="other"><pre>con.setTransactionIsolation(SQLServerConnection.TRANSACTION_SNAPSHOT);</pre></span></div><p>或者，您可以使用：</p><div class="sampleCode"><span codeLanguage="other"><pre>con.setTransactionIsolation(Connection.TRANSACTION_READ_COMMITTED + 4094);</pre></span></div><p>如需有關 SQL Server 隔離等級的詳細資訊，請參閱《SQL Server 線上叢書》的＜Database Engine 中的隔離等級＞。</p></div><span id="seeAlsoSpan"><h1 class="heading">請參閱</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="afbb776f-05dc-4e79-bb25-2c340483e401.htm">以 JDBC 驅動程式執行交易</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">將有關本主題的<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\d感謝您的意見反應。開發人員撰寫小組會使用您的意見反應改善文件集。檢閱意見反應的同時，我們可能會傳送電子郵件給您要求提供進一步說明或是解決方案的意見。電子郵件地址不會用於任何其他目的，檢閱後將會刪除。%0\A如需有關%20Microsoft%20隱私權原則的詳細資訊，請參閱%20http://privacy.microsoft.com/zh-tw/default.aspx。%0\A%0\d','客戶回函');">意見反應</a>傳送給 Microsoft。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.著作權所有，並保留一切權利。</a></p></span></div></div></body></html>