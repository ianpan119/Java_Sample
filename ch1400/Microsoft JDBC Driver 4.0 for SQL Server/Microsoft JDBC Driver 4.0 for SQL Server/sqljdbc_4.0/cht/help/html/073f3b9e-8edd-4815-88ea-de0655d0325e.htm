<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>了解 SSL 支援</title><meta name="Language" content="zh-cht" /><meta name="System.Keywords" content="加密" /><meta name="System.Keywords" content="SSL" /><meta name="Microsoft.Help.Id" content="073f3b9e-8edd-4815-88ea-de0655d0325e" /><meta name="Description" content="連接到 SQL Server 時，如果應用程式要求加密而且 SQL Server 的執行個體設定為支援 SSL 加密，Microsoft JDBC Driver for SQL Server 會起始 SSL 交握。交握可讓伺服器與用戶端交涉要用來保護資料的加密和密碼編譯演算法。SSL 交握完成後，用戶端和伺服器就可以安全地傳送加密的資料。在 SSL 交握期間，伺服器會將其公開金鑰憑證傳送到用戶端。公開金鑰憑證的發行者也就是所謂的「憑證授權單位 (CA)」。用戶端負責驗證憑證授權單位為用戶端所信任的憑證授權單" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">了解 SSL 支援</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>連接到 SQL Server 時，如果應用程式要求加密而且 SQL Server 的執行個體設定為支援 SSL 加密，Microsoft JDBC Driver for SQL Server 會起始 SSL 交握。交握可讓伺服器與用戶端交涉要用來保護資料的加密和密碼編譯演算法。SSL 交握完成後，用戶端和伺服器就可以安全地傳送加密的資料。在 SSL 交握期間，伺服器會將其公開金鑰憑證傳送到用戶端。公開金鑰憑證的發行者也就是所謂的「憑證授權單位 (CA)」。用戶端負責驗證憑證授權單位為用戶端所信任的憑證授權單位。</p><p>如果應用程式沒有要求加密，Microsoft JDBC Driver for SQL Server 將不會強制 SQL Server 支援 SSL 加密。如果 SQL Server 執行個體未設定成強制 SSL 加密，這時不用加密就可以建立連接。如果 SQL Server 執行個體設定為強制 SSL 加密，則在正確設定的 Java Virtual Machine (JVM) 上執行時，此驅動程式將會自動啟用 SSL 加密，否則連接會中止，而且驅動程式會引發錯誤。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>確定傳遞給 <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> 的值完全符合伺服器憑證中主旨替代名稱 (SAN) 內的一般名稱 (CN) 或 DNS 名稱，SSL 連接才會成功。</p></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>如需有關如何針對 SQL Server 設定 SSL 的詳細資訊，請參閱《SQL Server 線上叢書》中的＜加密 SQL Server 的連接＞主題。</p></div></div><h1 class="heading">備註</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>為了讓應用程式能夠使用 SSL 加密，Microsoft JDBC Driver for SQL Server 已從 1.2 版起導入下列連接屬性：<span class="label">encrypt</span>、<span class="label">trustServerCertificate</span>、<span class="label">trustStore</span>、<span class="label">trustStorePassword</span> 和 <span class="label">hostNameInCertificate</span>。如需詳細資訊，請參閱＜<span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">設定連接屬性</a></span>＞。</p><p>下表摘要說明 Microsoft JDBC Driver for SQL Server 版本如何針對可能的 SSL 連接狀況運作。每個狀況都使用一組不同的 SSL 連接屬性。此資料表包括：</p><ul><li><p><span sdata="langKeyword" value="blank"><span class="keyword">blank</span></span>：「屬性不存在於連接字串中」</p></li><li><p><span sdata="langKeyword" value="value"><span class="keyword">value</span></span>：「屬性存在於連接字串中，而且其值有效」</p></li><li><p><span sdata="langKeyword" value="any"><span class="keyword">any</span></span>：「屬性是否存在於連接字串中，或者其值是否有效都不重要」</p></li></ul><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>相同的行為也適用於 SQL Server 使用者驗證與 Windows 整合式驗證。</p></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>加密</p></th><th><p>trustServerCertificate</p></th><th><p>hostNameInCertificate</p></th><th><p>trustStore</p></th><th><p>trustStorePassword</p></th><th><p>行為</p></th></tr><tr><td><p>false 或空白</p></td><td><p>任意</p></td><td><p>任意</p></td><td><p>任意</p></td><td><p>任意</p></td><td><p>Microsoft JDBC Driver for SQL Server 將不會強制 SQL Server 支援 SSL 加密。如果伺服器有自我簽署憑證，驅動程式會起始 SSL 憑證交換。SSL 憑證將不會經過驗證，而且只有認證 (在登入封包中) 會經過加密。</p><p>如果伺服器需要用戶端支援 SSL 加密，驅動程式將會起始 SSL 憑證交換。SSL 憑證將不會經過驗證，但是整個通訊將會經過加密。</p></td></tr><tr><td><p>true</p></td><td><p>true</p></td><td><p>任意</p></td><td><p>任意</p></td><td><p>任意</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。請注意，如果 <span class="label">trustServerCertificate</span> 屬性設定為 "true"，驅動程式將不會驗證 SSL 憑證。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>空白</p></td><td><p>空白</p></td><td><p>空白</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將使用在連接 URL 上指定的 <span class="label">serverName</span> 屬性，驗證伺服器 SSL 憑證，並依賴信任管理員 Factory 的查閱規則決定要使用的憑證存放區。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>值</p></td><td><p>空白</p></td><td><p>空白</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將會使用針對 <span class="label">hostNameInCertificate</span> 屬性指定的值，驗證 SSL 憑證的主旨值。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>空白</p></td><td><p>值</p></td><td><p>值</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將會使用 <span class="label">trustStore</span> 屬性值來尋找憑證 trustStore 檔與 <span class="label">trustStorePassword</span> 屬性值以檢查 trustStore 檔的完整性。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>空白</p></td><td><p>空白</p></td><td><p>值</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將會使用 <span class="label">trustStorePassword</span> 屬性值來檢查預設 trustStore 檔的完整性。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>空白</p></td><td><p>值</p></td><td><p>空白</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將會使用 <span class="label">trustStore</span> 屬性值來查閱 trustStore 檔的位置。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>值</p></td><td><p>空白</p></td><td><p>值</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將會使用 <span class="label">trustStorePassword</span> 屬性值來檢查預設 trustStore 檔的完整性。此外，驅動程式將會使用 <span class="label">hostNameInCertificate</span> 屬性值來驗證 SSL 憑證。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>值</p></td><td><p>值</p></td><td><p>空白</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將會使用 <span class="label">trustStore</span> 屬性值來查閱 trustStore 檔的位置。此外，驅動程式將會使用 <span class="label">hostNameInCertificate</span> 屬性值來驗證 SSL 憑證。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr><tr><td><p>true</p></td><td><p>false 或空白</p></td><td><p>值</p></td><td><p>值</p></td><td><p>值</p></td><td><p>Microsoft JDBC Driver for SQL Server 要求搭配 SQL Server 使用 SSL 加密。</p><p>如果伺服器要求用戶端支援 SSL 加密，或者，如果伺服器支援加密，驅動程式將會起始 SSL 憑證交換。</p><p>驅動程式將會使用 <span class="label">trustStore</span> 屬性值來尋找憑證 trustStore 檔與 <span class="label">trustStorePassword</span> 屬性值以檢查 trustStore 檔的完整性。此外，驅動程式將會使用 <span class="label">hostNameInCertificate</span> 屬性值來驗證 SSL 憑證。</p><p>如果伺服器的設定不支援加密，驅動程式將引發錯誤，並中止連接。</p></td></tr></table></div><p>如果 encrypt 屬性設定為 <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>，Microsoft JDBC Driver for SQL Server 會使用 JVM 的預設 JSSE 安全性提供者與 SQL Server 交涉 SSL 加密。預設的安全性提供者可能不支援成功交涉 SSL 加密所需的所有功能。例如，預設的安全性提供者可能不支援 SQL Server SSL 憑證中使用之 RSA 公開金鑰的大小。在此情況下，預設的安全性提供者可能會引發錯誤，造成 JDBC 驅動程式中止連接。若要解決這個問題，請執行下列其中之一：</p><ul><li><p>利用具有較小 RSA 公開金鑰的伺服器憑證設定 SQL Server</p></li><li><p>設定 JVM 在 "&lt;java-home&gt;/lib/security/java.security" 安全性屬性檔中使用不同的 JSSE 安全性提供者</p></li><li><p>使用不同的 JVM</p></li></ul></div><h1 class="heading">驗證 Server SSL 憑證</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>在 SSL 交握期間，伺服器會將其公開金鑰憑證傳送到用戶端。JDBC 驅動程式或用戶端必須驗證伺服器憑證是由用戶端所信任的憑證授權單位發行。驅動程式會要求伺服器憑證必須符合下列條件：</p><ul><li><p>憑證由信任的憑證授權單位所發行。</p></li><li><p>憑證必須針對伺服器驗證而發行。</p></li><li><p>憑證未過期。</p></li><li><p>憑證之主旨內的一般名稱 (CN) 或是主旨替代名稱 (SAN) 內的 DNS 名稱會完全符合連接字串內所指定的 <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> 值或是 <span sdata="langKeyword" value="hostNameInCertificate"><span class="keyword">hostNameInCertificate</span></span> 屬性值 (如果指定的話)。</p></li><li><p>DNS 名稱可包含萬用字元。但是 Microsoft JDBC Driver for SQL Server 不支援萬用字元比對。也就是說，abc.com 不會符合 *.com 但是 *.com 會符合 *.com。</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">請參閱</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">使用 SSL 加密</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">保護 JDBC Driver 應用程式</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">將有關本主題的<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\d感謝您的意見反應。開發人員撰寫小組會使用您的意見反應改善文件集。檢閱意見反應的同時，我們可能會傳送電子郵件給您要求提供進一步說明或是解決方案的意見。電子郵件地址不會用於任何其他目的，檢閱後將會刪除。%0\A如需有關%20Microsoft%20隱私權原則的詳細資訊，請參閱%20http://privacy.microsoft.com/zh-tw/default.aspx。%0\A%0\d','客戶回函');">意見反應</a>傳送給 Microsoft。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.著作權所有，並保留一切權利。</a></p></span></div></div></body></html>