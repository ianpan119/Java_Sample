<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>設定連接屬性</title><meta name="Language" content="zh-cht" /><meta name="System.Keywords" content="連接屬性" /><meta name="Microsoft.Help.Id" content="f1b62700-f046-488d-bd6b-a5cd8fc345b7" /><meta name="Description" content="您可以使用各種方法指定連接字串屬性：" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">設定連接屬性</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>您可以使用各種方法指定連接字串屬性：</p><ul><li><p>當您使用 <b>DriverManager</b> 類別進行連接時，連接 URL 中的屬性為 name=value。</p></li><li><p>作為 <b>DriverManager</b> 類別內 <b>Connect</b> 方法之 <span class="parameter" sdata="paramReference">Properties</span> 參數中的 name=value 屬性。</p></li><li><p>作為驅動程式資料來源的適當 setter 方法中的值。例如：</p><div class="sampleCode"><span codeLanguage="other"><pre><span class="label">datasource.setServerName(value)</span><br /><span class="label">datasource.setDatabaseName(value)</span></pre></span></div></li></ul></div><h1 class="heading">備註</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>屬性名稱需區分大小寫，而重複的屬性名稱將以下列順序解析：</p><ol><li><p>API 引數 (例如使用者及密碼)</p></li><li><p>屬性集合。</p></li><li><p>連接字串內的最後一個執行個體。</p></li></ol><p>此外，屬性名稱可允許未知的值，JDBC 驅動程式並不會針對屬性值的大小寫進行驗證。</p><p>容許同義字並會依序解析，如同是重複的屬性名稱一般。</p><p>下表列出 JDBC 驅動程式目前所有可用的連接字串屬性。</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>屬性</p></th><th><p>型別</p></th><th><p>預設值</p></th><th><p>說明</p></th></tr><tr><td><p>applicationIntent</p></td><td><p>String</p></td><td><p><span sdata="langKeyword" value="ReadWrite"><span class="keyword">ReadWrite</span></span></p></td><td><p>在連接到伺服器時宣告應用程式工作負載類型。可能的值為 <span sdata="langKeyword" value="ReadOnly"><span class="keyword">ReadOnly</span></span> 和 <span sdata="langKeyword" value="ReadWrite"><span class="keyword">ReadWrite</span></span>。如需詳細資訊，請參閱＜<span sdata="link"><a href="62de4be6-b027-427d-a7e5-352960e42877.htm">JDBC 驅動程式對於高可用性、災害復原的支援</a></span>＞。</p></td></tr><tr><td><p>applicationName</p></td><td><p>String</p><p>[&lt;=128 char]</p></td><td><p>null</p></td><td><p>應用程式名稱，如果未提供名稱，則為 "Microsoft JDBC Driver for SQL Server"。用以識別各種 SQL Server 設定檔作業與記錄工具中的特定應用程式。</p></td></tr><tr><td><p>authenticationScheme</p></td><td><p>String</p></td><td><p>"NativeAuthentication"</p></td><td><p>表示您希望應用程式使用的整合式安全性種類。可能的值為 <span sdata="langKeyword" value="JavaKerberos"><span class="keyword">JavaKerberos</span></span> 和預設值 <span sdata="langKeyword" value="NativeAuthentication"><span class="keyword">NativeAuthentication</span></span>。</p><p>當使用 <span sdata="langKeyword" value="authenticationScheme=JavaKerberos"><span class="keyword">authenticationScheme=JavaKerberos</span></span> 時，您必須在 <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> 屬性中指定完整網域名稱 (FQDN)。否則會發生錯誤 (Kerberos 資料庫中找不到伺服器)。</p><p>如需有關使用 <span sdata="langKeyword" value="authenticationScheme"><span class="keyword">authenticationScheme</span></span> 的詳細資訊，請參閱＜<span sdata="link"><a href="687802dc-042a-4363-89aa-741685d165b3.htm">使用 Kerberos 整合式驗證連接到 SQL Server</a></span>＞。</p></td></tr><tr><td><p>databaseName, database</p></td><td><p>String</p><p>[&lt;=128 char]</p></td><td><p>null</p></td><td><p>要連接的資料庫名稱。如果沒有指定，將連接到預設資料庫。</p></td></tr><tr><td><p>disableStatementPooling</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>true</p></td><td><p>目前僅支援 "true" 值。如果設定為 "false"，則會發生例外狀況。</p></td></tr><tr><td><p>加密</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>false</p></td><td><p>如果伺服器有安裝憑證，設定為 "true" 以指定 SQL Server 將安全通訊端層 (SSL) 加密用於用戶端和伺服器之間的所有資料。預設值為 false。</p></td></tr><tr><td><p>failoverPartner</p></td><td><p>String</p></td><td><p>null</p></td><td><p>用於資料庫鏡像組態的容錯移轉伺服器名稱。初始連接到主體伺服器若失敗，將使用此屬性；在建立初始連接之後，將忽略此屬性。必須與 databaseName 屬性一起使用。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>此驅動程式不支援在連接字串中指定容錯移轉夥伴執行個體的伺服器執行個體通訊埠號碼當做 failoverPartner 屬性的一部分。不過，它支援在相同的連接字串中指定主體伺服器執行個體的 serverName、instanceName 和 portNumber 屬性以及容錯移轉夥伴執行個體的 failoverPartner 屬性。</p></div><p>如果您在 <span sdata="langKeyword" value="Server"><span class="keyword">Server</span></span> 連接屬性中指定虛擬網路名稱，您不能使用資料庫鏡像。如需詳細資訊，請參閱＜<span sdata="link"><a href="62de4be6-b027-427d-a7e5-352960e42877.htm">JDBC 驅動程式對於高可用性、災害復原的支援</a></span>＞。</p></td></tr><tr><td><p>hostNameInCertificate</p></td><td><p>String</p></td><td><p>null</p></td><td><p>用於驗證 SQL Server SSL 憑證的主機名稱。</p><p>如果未指定 hostNameInCertificate 屬性，或設定為 null，Microsoft JDBC Driver for SQL Server 將會在連接 URL 上使用 <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> 屬性值，當做驗證 SQL Server SSL 憑證的主機名稱。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>此屬性與 <span sdata="langKeyword" value="encrypt"><span class="keyword">encrypt</span></span> 屬性和 <span sdata="langKeyword" value="trustServerCertificate"><span class="keyword">trustServerCertificate</span></span> 屬性搭配使用。只有在 <span sdata="langKeyword" value="encrypt"><span class="keyword">encrypt</span></span> 屬性設定為 "true"，而且 <span sdata="langKeyword" value="trustServerCertificate"><span class="keyword">trustServerCertificate</span></span> 設定為 "false" 時，這個屬性才會影響憑證驗證。確定傳遞給 <span sdata="langKeyword" value="hostNameInCertificate"><span class="keyword">hostNameInCertificate</span></span> 的值完全符合伺服器憑證中主旨替代名稱 (SAN) 內的一般名稱 (CN) 或 DNS 名稱，SSL 連接才會成功。如需詳細資訊，請參閱＜<span sdata="link"><a href="073f3b9e-8edd-4815-88ea-de0655d0325e.htm">了解 SSL 支援</a></span>＞。</p></div></td></tr><tr><td><p>instanceName</p></td><td><p>String</p><p>[&lt;=128 char]</p></td><td><p>null</p></td><td><p>要連接的 SQL Server 執行個體名稱。如果未指定，將會連接到預設執行個體。如果已指定 instanceName 與通訊埠，請參閱通訊埠的注意事項。</p><p>如果您在 <span sdata="langKeyword" value="Server"><span class="keyword">Server</span></span> 連接屬性中指定虛擬網路名稱，您不能使用 <span sdata="langKeyword" value="instanceName"><span class="keyword">instanceName</span></span> 連接屬性。如需詳細資訊，請參閱＜<span sdata="link"><a href="62de4be6-b027-427d-a7e5-352960e42877.htm">JDBC 驅動程式對於高可用性、災害復原的支援</a></span>＞。</p></td></tr><tr><td><p>integratedSecurity</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>false</p></td><td><p>設為 "true"，以指出 SQL Server 將使用 Windows 認證來驗證應用程式的使用者。若為 "true"，JDBC 驅動程式會搜尋本機電腦認證快取，以取得電腦上已提供的認證或網路登入。若為 "false"，必須提供使用者名稱及密碼。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>只在 Microsoft Windows 作業系統上才支援此連接屬性。</p></div></td></tr><tr><td><p>lastUpdateCount</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>true</p></td><td><p>"true" 值只會從傳至伺服器的 SQL 陳述式傳回上次更新計數，而且它可以用在單一 SELECT、INSERT 或 DELETE 陳述式，以忽略伺服器觸發程序所導致的其他更新計數。將此屬性設為 "false" 會導致傳回所有更新計數，包括伺服器觸發程序所傳回的更新計數。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>此屬性僅適用於搭配 <a href="10ae662a-ce3c-4b24-875c-5c2df319d93b.htm">executeUpdate</a> 方法使用時。所有其他 <b>execute</b> 方法都會傳回所有結果並更新計數。</p><p>這個屬性只會影響伺服器觸發程序所傳回的更新計數。它不會影響結果集或觸發程序執行期間產生的錯誤。</p></div></td></tr><tr><td><p>lockTimeout</p></td><td><p>int</p></td><td><p>-1</p></td><td><p>等候資料庫報告鎖定逾時的毫秒數。預設的行為是無限期等待。如果已指定，則此值為連接上所有陳述式的預設值。請注意，<span class="code"> Statement.setQueryTimeout() </span>可用來設定特定陳述式的逾時。此值可以為 0，表示不等待。</p></td></tr><tr><td><p>loginTimeout</p></td><td><p>int [0..65535]</p></td><td><p>15</p></td><td><p>驅動程式應等待失敗連接逾時的秒數。值為零表示此逾時為預設系統逾時，預設指定為 15 秒。非零值為驅動程式應等待失敗連接之逾時的秒數。</p><p>如果您在 <span sdata="langKeyword" value="Server"><span class="keyword">Server</span></span> 連接屬性中指定虛擬網路名稱，您應該指定三分鐘或更長的逾時值，好讓容錯移轉連接有充足的時間可以順利完成。如需詳細資訊，請參閱＜<span sdata="link"><a href="62de4be6-b027-427d-a7e5-352960e42877.htm">JDBC 驅動程式對於高可用性、災害復原的支援</a></span>＞。</p></td></tr><tr><td><p>multiSubnetFailover</p></td><td><p>布林值</p></td><td><p>false</p></td><td><p>當連接到 SQL Server 2012 可用性群組的可用性群組接聽程式或是 SQL Server 2012 容錯移轉叢集執行個體時，一定要指定 <span sdata="langKeyword" value="multiSubnetFailover=true"><span class="keyword">multiSubnetFailover=true</span></span>。<span sdata="langKeyword" value="multiSubnetFailover=true"><span class="keyword">multiSubnetFailover=true</span></span> 會設定 Microsoft JDBC Driver for SQL Server 以更快的速度偵測和連接至 (目前) 使用中的伺服器。可能的值為 true 和 false。如需詳細資訊，請參閱＜<span sdata="link"><a href="62de4be6-b027-427d-a7e5-352960e42877.htm">JDBC 驅動程式對於高可用性、災害復原的支援</a></span>＞。</p><p>您可使用 <a href="b5eaad8a-31ef-44ac-af11-d5caa13ac3e2.htm">getPropertyInfo</a>、<a href="1e8cb175-5f4c-4208-b4f5-3646990a30e3.htm">getMultiSubnetFailover</a> 和 <a href="7ffd282d-c2f6-4d1b-a7a6-859d18b388aa.htm">setMultiSubnetFailover</a> 來以程式設計方式存取 <span sdata="langKeyword" value="multiSubnetFailover"><span class="keyword">multiSubnetFailover</span></span> 連接屬性。</p></td></tr><tr><td><p>packetSize</p></td><td><p>int [-1| 0 | 512..32767]</p></td><td><p>8000</p></td><td><p>用來與 SQL Server 通訊的網路封包大小 (以位元組指定)。-1 這個值表示使用伺服器的預設封包大小。0 這個值表示使用最大值，也就是 32767。如果將此屬性設為可接受範圍以外的值，將發生例外狀況。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>啟用加密 (encrypt=true) 時，不建議使用 packetSize 屬性。否則，驅動程式可能會引發連接錯誤。如需詳細資訊，請參閱 <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a> 類別的 <a href="5d490edc-a223-4870-a838-784952497e5f.htm">setPacketSize</a> 方法。</p></div></td></tr><tr><td><p>password</p></td><td><p>String</p><p>[&lt;=128 char]</p></td><td><p>null</p></td><td><p>資料庫密碼。</p></td></tr><tr><td><p>portNumber, port</p></td><td><p>int [0..65535]</p></td><td><p>1433</p></td><td><p>SQL Server 正在接聽的通訊埠。如果已在連接字串中指定通訊埠號碼，就不需要對 sqlbrowser 進行要求。同時指定 port 和 instanceName 時，會連接至指定的通訊埠。然而會驗證 <span sdata="langKeyword" value="instanceName"><span class="keyword">instanceName</span></span>，如果它不符合通訊埠，將會擲回錯誤。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>我們建議一定要指定通訊埠號碼，因為這比使用 sqlbrowser 更安全。</p></div></td></tr><tr><td><p>responseBuffering</p></td><td><p>String</p><p>["full"|"adaptive"]</p></td><td><p>adaptive</p></td><td><p>如果此屬性設定為 "adaptive"，就會在必要時緩衝處理可能的資料下限。預設模式為 "adaptive"。</p><p>如果此屬性設定為 "full"，執行陳述式時，就會從伺服器讀取整個結果集。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p /><p>在將 JDBC Driver 從 1.2 版升級之後，預設的緩衝行為將成為 "adaptive"。如果應用程式從未設定 "responseBuffering" 屬性，而且您想要在應用程式中保留 1.2 版的預設行為，就必須在連接屬性中或使用 <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a> 物件的 <a href="9f489835-6cda-4c8c-b139-079639a169cf.htm">setResponseBuffering</a> 方法，將 responseBufferring 屬性設定為 "full"。</p></div></td></tr><tr><td><p>selectMethod</p></td><td><p>String</p><p>["direct"|"cursor"]</p></td><td><p>direct</p></td><td><p>如果將此屬性設定為 "cursor"，便會為每個在 TYPE_FORWARD_ONLY 及 CONCUR_READ_ONLY 資料指標之連接上建立的查詢，建立資料庫資料指標。通常只有當應用程式所產生的結果集過於龐大而用戶端記憶體無法全數包含時，才需要此屬性。此屬性設定為 "cursor" 時，用戶端記憶體中只會保留有限數量的結果集資料列。預設的行為是用戶端記憶體中保留了所有結果集資料列。當應用程式處理所有資料列時，此行為提供最快的效能。</p></td></tr><tr><td><p>sendStringParametersAsUnicode</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>true</p></td><td><p>如果 <span sdata="langKeyword" value="sendStringParametersAsUnicode"><span class="keyword">sendStringParametersAsUnicode</span></span> 屬性設定為 "true"，則會以 Unicode 格式將 String 參數傳送到伺服器。</p><p>如果 <span sdata="langKeyword" value="sendStringParametersAsUnicode"><span class="keyword">sendStringParametersAsUnicode</span></span> 屬性設定為 "false"，String 參數就會以非 Unicode 格式 (例如 ASCII/MBCS) 而非 Unicode 傳送至伺服器。</p><p><span sdata="langKeyword" value="sendStringParametersAsUnicode"><span class="keyword">sendStringParametersAsUnicode</span></span> 屬性的預設值為 "true"。</p><p /><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>只有在傳送具有 <span sdata="langKeyword" value="CHAR"><span class="keyword">CHAR</span></span>、<span sdata="langKeyword" value="VARCHAR"><span class="keyword">VARCHAR</span></span> 或 <span sdata="langKeyword" value="LONGVARCHAR"><span class="keyword">LONGVARCHAR</span></span> JDBC 類型的參數值時，才會檢查 <span sdata="langKeyword" value="sendStringParametersAsUnicode"><span class="keyword">sendStringParametersAsUnicode</span></span> 屬性。不論這個屬性的設定為何，<a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> 和 <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別的 <b>setNString</b>、<b>setNCharacterStream</b> 和 <b>setNClob</b> 方法等新 JDBC 4.0 國家字元方法一律會以 Unicode 將參數值傳送至伺服器。</p><p>若要讓 <span sdata="langKeyword" value="CHAR"><span class="keyword">CHAR</span></span>、<span sdata="langKeyword" value="VARCHAR"><span class="keyword">VARCHAR</span></span> 和 <span sdata="langKeyword" value="LONGVARCHAR"><span class="keyword">LONGVARCHAR</span></span> JDBC 資料類型達到最佳效能，應用程式應該將 <span sdata="langKeyword" value="sendStringParametersAsUnicode"><span class="keyword">sendStringParametersAsUnicode</span></span> 屬性設定為 "false"，並且使用 <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> 和 <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別的 <b>setString</b>、<b>setCharacterStream</b> 和 <b>setClob</b> 非國家字元方法。</p><p>當應用程式將 <span sdata="langKeyword" value="sendStringParametersAsUnicode"><span class="keyword">sendStringParametersAsUnicode</span></span> 屬性設定為 "false" 並且使用非國家字元方法來存取伺服器端的 Unicode 資料類型 (例如 <span sdata="langKeyword" value="nchar"><span class="keyword">nchar</span></span>、<span sdata="langKeyword" value="nvarchar"><span class="keyword">nvarchar</span></span> 和 <span sdata="langKeyword" value="ntext"><span class="keyword">ntext</span></span>) 時，如果資料庫定序不支援非國家字元方法所傳遞之 String 參數中的字元，某些資料可能會遺失。</p><p>請注意，應用程式應該針對 <span sdata="langKeyword" value="NCHAR"><span class="keyword">NCHAR</span></span>、<span sdata="langKeyword" value="NVARCHAR"><span class="keyword">NVARCHAR</span></span> 和 <span sdata="langKeyword" value="LONGNVARCHAR"><span class="keyword">LONGNVARCHAR</span></span> JDBC 資料類型使用 <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> 和 <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別的 <b>setNString</b>、<b>setNCharacterStream</b> 和 <b>setNClob</b> 國家字元方法。</p></div></td></tr><tr><td><p>sendTimeAsDatetime</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>true</p></td><td><p>這個屬性是在 SQL Server JDBC Driver 3.0 中所加入。</p><p>當為 true 時，會將 java.sql.Time 值當做 SQL Server <span sdata="langKeyword" value="datetime"><span class="keyword">datetime</span></span> 值傳送給伺服器。</p><p>當為 false 時，會將 java.sql.Time 值當做 SQL Server <span sdata="langKeyword" value="time"><span class="keyword">time</span></span> 值傳送給伺服器。</p><p><span sdata="langKeyword" value="sendTimeAsDatetime"><span class="keyword">sendTimeAsDatetime</span></span> 也可以利用 <a href="705a0494-b5e2-43db-940a-1b8cec550cdb.htm">SQLServerDataSource.setSendTimeAsDatetime</a> 來以程式設計方式加以修改。</p><p>這個屬性的預設值在後續版本可能會變更。</p><p>如需有關 Microsoft JDBC Driver for SQL Server 如何設定 java.sql.Time 值然後傳送給伺服器的詳細資訊，請參閱＜<span sdata="link"><a href="07eb00dd-621a-46f9-a5a5-8cab4d6058b5.htm">設定 java.sql.Time 值如何傳送給伺服器</a></span>＞。</p></td></tr><tr><td><p>serverName, server</p></td><td><p>String</p></td><td><p>null</p></td><td><p>執行 SQL Server 的電腦。</p><p>您也可以指定 AlwaysOn 可用性群組 可用性群組的虛擬網路名稱。如需詳細資訊，請參閱＜<span sdata="link"><a href="62de4be6-b027-427d-a7e5-352960e42877.htm">JDBC 驅動程式對於高可用性、災害復原的支援</a></span>＞。</p></td></tr><tr><td><p>trustServerCertificate</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>false</p></td><td><p>設定為 "true" 以指定 Microsoft JDBC Driver for SQL Server 將不會驗證 SQL Server SSL 憑證。</p><p>若為 "true"，當通訊層使用 SSL 加密時，會自動信任 SQL Server SSL 憑證。</p><p>若為 "false"，Microsoft JDBC Driver for SQL Server 將會驗證伺服器 SSL 憑證。如果伺服器憑證驗證失敗，驅動程式將引發錯誤，並中止連接。預設值為 "false"。確定傳遞給 <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> 的值完全符合伺服器憑證中主旨替代名稱內的一般名稱 (CN) 或 DNS 名稱，SSL 連接才會成功。如需詳細資訊，請參閱＜<span sdata="link"><a href="073f3b9e-8edd-4815-88ea-de0655d0325e.htm">了解 SSL 支援</a></span>＞。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>此屬性會與 <span sdata="langKeyword" value="encrypt"><span class="keyword">encrypt</span></span> 屬性一起使用。只有在 <span sdata="langKeyword" value="encrypt"><span class="keyword">encrypt</span></span> 屬性設定為 "true" 時，這個屬性才會影響伺服器 SSL 憑證驗證。</p></div></td></tr><tr><td><p>trustStore</p></td><td><p>String</p></td><td><p>null</p></td><td><p>trustStore 憑證檔案的路徑 (包括檔案名稱)。trustStore 檔案包含用戶端所信任之憑證的清單。</p><p>未指定此屬性或將其設定為 null 時，驅動程式將會依賴信任管理員 Factory 的查閱規則，決定要使用的憑證存放區。</p><p>預設的 SunX509 TrustManagerFactory 會嘗試以下列的搜尋順序，找出信任的資料：</p><ul><li><p>由 "javax.net.ssl.trustStore" Java Virtual Machine (JVM) 系統屬性所指定的檔案。</p></li><li><p>"&lt;java-home&gt;/lib/security/jssecacerts" 檔案。</p></li><li><p>"&lt;java-home&gt;/lib/security/cacerts" 檔案。</p></li></ul><p>如需詳細資訊，請參閱 Sun Microsystems 網站上的 SUNX509 TrustManager 介面文件。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>當 (並僅有在) <span sdata="langKeyword" value="encrypt"><span class="keyword">encrypt</span></span> 屬性設定為 "true"，而且 <span sdata="langKeyword" value="trustServerCertificate"><span class="keyword">trustServerCertificate</span></span> 屬性設定為 "false" 時，這個屬性才會影響憑證 trustStore 查閱。</p></div></td></tr><tr><td><p>trustStorePassword</p></td><td><p>String</p></td><td><p>null</p></td><td><p>用於檢查 trustStore 資料完整性的密碼。</p><p>如果有設定 trustStore 屬性，但是未設定 trustStorePassword 屬性，就不會檢查 trustStore 的完整性。</p><p>當 trustStore 和 trustStorePassword 屬性都未指定時，驅動程式將會使用 JVM 系統屬性 "javax.net.ssl.trustStore" 和 "javax.net.ssl.trustStorePassword"。如果未指定 "javax.net.ssl.trustStorePassword" 系統屬性，就不會檢查 trustStore 的完整性。</p><p>如果未設定 trustStore 屬性，但是有設定 trustStorePassword 屬性，JDBC 驅動程式將會使用 "javax.net.ssl.trustStore" 指定的檔案做為信任存放區，並使用指定的 trustStorePassword，檢查信任存放區的完整性。當用戶端應用程式不要在 JVM 系統屬性中儲存密碼時，可能需要這個動作。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>當 (並僅有在) <span sdata="langKeyword" value="encrypt"><span class="keyword">encrypt</span></span> 屬性設定為 "true"，而且 <span sdata="langKeyword" value="trustServerCertificate"><span class="keyword">trustServerCertificate</span></span> 屬性設定為 "false" 時，trustStorePassword 屬性才會影響憑證 trustStore 查閱。</p></div></td></tr><tr><td><p>userName, user</p></td><td><p>String</p><p>[&lt;=128 char]</p></td><td><p>null</p></td><td><p>資料庫使用者。</p></td></tr><tr><td><p>workstationID</p></td><td><p>String</p><p>[&lt;=128 char]</p></td><td><p>&lt;empty string&gt;</p></td><td><p>工作站識別碼。用以識別各種 SQL Server 設定檔作業與記錄工具中的特定工作站。若未指定，則使用 &lt;empty string&gt;。</p></td></tr><tr><td><p>xopenStates</p></td><td><p>boolean</p><p>["true"|"false"]</p></td><td><p>false</p></td><td><p>設定為 "true"，以指定驅動程式傳回例外狀況的 XOPEN 相容狀態碼。預設為傳回 SQL 99 狀態碼。</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Microsoft JDBC Driver for SQL Server 會針對連接屬性採用伺服器預設值，但是 ANSI_DEFAULTS 和 IMPLICIT_TRANSACTIONS 除外。Microsoft JDBC Driver for SQL Server 會自動將 ANSI_DEFAULTS 設定為 ON，並將 IMPLICIT_TRANSACTIONS 設定為 OFF。</p></div></div><span id="seeAlsoSpan"><h1 class="heading">請參閱</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="94bcfbe3-f00e-4774-bda8-bb7577518fec.htm">使用 JDBC 驅動程式連接到 SQL Server</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">將有關本主題的<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\d感謝您的意見反應。開發人員撰寫小組會使用您的意見反應改善文件集。檢閱意見反應的同時，我們可能會傳送電子郵件給您要求提供進一步說明或是解決方案的意見。電子郵件地址不會用於任何其他目的，檢閱後將會刪除。%0\A如需有關%20Microsoft%20隱私權原則的詳細資訊，請參閱%20http://privacy.microsoft.com/zh-tw/default.aspx。%0\A%0\d','客戶回函');">意見反應</a>傳送給 Microsoft。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.著作權所有，並保留一切權利。</a></p></span></div></div></body></html>