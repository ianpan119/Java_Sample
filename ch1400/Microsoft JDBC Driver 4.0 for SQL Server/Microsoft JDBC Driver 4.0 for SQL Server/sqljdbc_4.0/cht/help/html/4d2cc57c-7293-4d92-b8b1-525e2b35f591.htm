<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>使用 SQLXML 進行程式設計</title><meta name="Language" content="zh-cht" /><meta name="System.Keywords" content="適應性緩衝" /><meta name="System.Keywords" content="使用 sqlxml 進行程式設計" /><meta name="System.Keywords" content="sqlxml" /><meta name="System.Keywords" content="xml" /><meta name="Microsoft.Help.Id" content="4d2cc57c-7293-4d92-b8b1-525e2b35f591" /><meta name="Description" content="本節將描述如何使用 Microsoft JDBC Driver for SQL Server API 方法，在具有 SQLXML 物件的關聯式資料庫中儲存並擷取 XML 文件。" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">使用 SQLXML 進行程式設計</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>本節將描述如何使用 Microsoft JDBC Driver for SQL Server API 方法，在具有 <span sdata="langKeyword" value="SQLXML"><span class="keyword">SQLXML</span></span> 物件的關聯式資料庫中儲存並擷取 XML 文件。</p><p>本節同時包含有關 SQLXML 物件類型的資訊，並提供使用 SQLXML 物件時重要指導方針和限制的清單。</p></div><h1 class="heading">讀取和寫入具有 SQLXML 物件的 XML 資料</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>下列清單將描述如何使用 Microsoft JDBC Driver for SQL Server API 方法來讀取和寫入具有 SQLXML 物件的 XML 資料：</p><ul><li><p>若要建立 SQLXML 物件，請使用 <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> 類別的 <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> 方法。請注意，這種方法會建立不含任何資料的 SQLXML 物件。若要將 <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> 資料加入至 SQLXML 物件，請呼叫 SQLXML 介面中指定的下列其中一種方法：<b>setResult</b>、<b>setCharacterStream</b>、<b>setBinaryStream</b> 或 <b>setString</b>。</p></li><li><p>若要擷取 SQLXML 物件本身，請使用 <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> 類別或 <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別的 <b>getSQLXML</b> 方法。</p></li><li><p>若要從 SQLXML 物件中擷取 <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> 資料，請呼叫 SQLXML 介面中指定的下列其中一種方法：<b>getSource</b>、<b>getCharacterStream</b>、<b>getBinaryStream</b> 或 <b>getString</b>。</p></li><li><p>若要更新 SQLXML 物件中的 <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> 資料，請使用 <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> 類別的 <a href="abe8ff37-72e5-4ec1-a226-6b68dbf2c1b4.htm">updateSQLXML</a> 方法。</p></li><li><p>若要在 <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> 類型的資料庫資料表資料行中儲存 SQLXML 物件，請使用 <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> 類別或 <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別的 <b>setSQLXML</b> 方法。</p></li></ul><p>＜<a href="8f2ff25b-71fd-46d7-b6de-d656095d2aad.htm">SQLXML 資料類型範例</a>＞中的範例程式碼將示範如何執行這些常見的 API 工作。</p></div><h1 class="heading">可讀取和可寫入的 SQLXML 物件</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>下表將列出 JDBC API 提供之 setter、getter 和 updater 方法所支援的 SQLXML 物件類型。此表格中的欄位代表下列項目：</p><ul><li><p><b>方法名稱</b>欄位會列出 JDBC API 中支援的 getter、setter 和 updater 方法。</p></li><li><p><b>Getter SQLXML 物件</b>欄位代表 <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別的 <a href="8bcf9eda-b36c-480c-8bf2-91c392d5a0ee.htm">getSQLXML</a> 方法或 <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> 類別的 <a href="a07e0f30-cbc6-4ad7-b931-c30cad382e64.htm">getSQLXML</a> 方法所建立的 SQLXML 物件。</p></li><li><p><b>Setter SQLXML 物件</b>欄位代表 <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> 類別的 <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> 方法所建立的 SQLXML 物件。請注意，下列 setter 方法僅接受 <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> 方法所建立的 SQLXML 物件。</p></li></ul><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>方法名稱</p></th><th><p>Getter SQLXML 物件</p><p>(可讀取)</p></th><th><p>Setter SQLXML 物件</p><p>(可寫入)</p></th></tr><tr><td><p><b>CallableStatement.setSQLXML()</b></p></td><td><p>不支援</p></td><td><p>支援</p></td></tr><tr><td><p><b>CallableStatement.setObject()</b></p></td><td><p>不支援</p></td><td><p>支援</p></td></tr><tr><td><p><b>PreparedStatement.setSQLXML()</b></p></td><td><p>不支援</p></td><td><p>支援</p></td></tr><tr><td><p><b>PreparedStatement.setObject()</b></p></td><td><p>不支援</p></td><td><p>支援</p></td></tr><tr><td><p><b>ResultSet.updateSQLXML()</b></p></td><td><p>不支援</p></td><td><p>支援</p></td></tr><tr><td><p><b>ResultSet.updateObject()</b></p></td><td><p>不支援</p></td><td><p>支援</p></td></tr><tr><td><p><b>ResultSet.getSQLXML()</b></p></td><td><p>支援</p></td><td><p>不支援</p></td></tr><tr><td><p><b>CallableStatement.getSQLXML()</b></p></td><td><p>支援</p></td><td><p>不支援</p></td></tr></table></div><p>如上表所示，setter SQLXML 方法無法使用可讀取的 SQLXML 物件。同樣地，getter 方法無法使用可寫入的 SQLXML 物件。</p><p>如果應用程式透過指定具有 SQLXML 物件的小數位數或長度參數叫用 <b>setObject</b> 方法，系統就會忽略此小數位數或長度參數。</p></div><h1 class="heading">使用 SQLXML 物件時的指導方針和限制</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>應用程式可以使用 SQLXML 物件，在資料庫中讀取和寫入 XML 資料。下列清單將提供有關使用 SQLXML 物件時特定限制和指引的資訊：</p><ul><li><p>SQLXML 物件只有在建立此物件的交易持續期間有效。</p></li><li><p>從 getter 方法擷取的 SQLXML 物件只能用來讀取資料。</p></li><li><p>連接物件所建立的 SQLXML 物件只能用來寫入資料。</p></li><li><p>應用程式只能針對可讀取的 SQLXML 物件叫用單一 getter 方法來讀取資料。叫用 getter 方法之後，相同 SQLXML 物件上的所有其他 getter 或 setter 方法都會失敗。</p></li><li><p>讀取或寫入 SQLXML 物件之後，應用程式只能針對此物件叫用 <b>free</b> 方法。不過，只要基礎資料行或參數使用中，它仍然能夠處理傳回的資料流或來源。如果基礎資料行或參數變成非使用中，與 SQLXML 物件相關聯的資料流或來源將會關閉。如果基礎資料行或參數不再有效，基礎資料將不適用於 Stream、Simple API for XML (SAX) 和 Streaming API for XML (StAX) getter。</p></li><li><p>應用程式只能針對可寫入的 SQLXML 物件叫用單一 setter 方法。叫用 setter 方法之後，相同 SQLXML 物件上的所有其他 setter 或 getter 方法都會失敗。</p></li><li><p>若要設定 SQLXML 物件的資料，應用程式必須在傳回的物件中使用適當的 setter 方法與函數。</p></li><li><p>如果基礎資料行為 <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>，<a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別和 <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> 類別的 <b>getSQLXML</b> 方法就會傳回 <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> 資料。</p></li><li><p>setter 物件可以透過在其中建立這些物件的連接生效。</p></li><li><p>應用程式無法使用 SQLXML 介面所提供的 setter 方法來設定 <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> 值。應用程式可以使用 SQLXML 介面中提供的 setter 方法來設定空字串 ("")。若要設定 <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> 值，應用程式應該呼叫下列其中一種方法：</p><ul><li><p><a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別和 <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> 類別的 <b>setNull</b> 方法。</p></li><li><p><a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別和 <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> 類別的 <b>setObject</b> 方法。</p></li><li><p><a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> 類別和 <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> 類別的方法 <b>setSQLXML</b> 方法並搭配 <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> 參數值。</p></li></ul></li><li><p>基於效能考量，使用 XML 文件時，我們建議您使用 Simple API for XML (SAX) 和 Streaming API for XML (StAX) 剖析器，而非文件物件模型 (DOM) 剖析器。</p></li></ul><p>XML 剖析器無法處理空值。不過，SQL Server 允許應用程式在 XML 資料類型的資料庫資料行中擷取和儲存空值。這表示，剖析 XML 資料時，如果基礎值是空的，剖析器就會擲回例外狀況。若為 DOM 輸出，JDBC Driver 會捕捉例外狀況並擲回錯誤。若為 SAX 和 Stax 輸出，錯誤則直接來自剖析器。</p></div><h1 class="heading">適應性緩衝和 SQLXML 支援</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>SQLXML 物件所傳回的二進位和字元資料流會遵循適應性或完整緩衝模式。反之，如果 XML 剖析器不是資料流，它們就不會遵循適應性或完整設定。如需有關適應性緩衝的詳細資訊，請參閱＜<span sdata="link"><a href="92d4e3be-c3e9-4732-9a60-b57f4d0f7cb7.htm">使用適應性緩衝</a></span>＞。</p></div><span id="seeAlsoSpan"><h1 class="heading">請參閱</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="32b7217e-1f0c-473d-9a45-176daa81584e.htm">支援 XML 資料</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">將有關本主題的<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\d感謝您的意見反應。開發人員撰寫小組會使用您的意見反應改善文件集。檢閱意見反應的同時，我們可能會傳送電子郵件給您要求提供進一步說明或是解決方案的意見。電子郵件地址不會用於任何其他目的，檢閱後將會刪除。%0\A如需有關%20Microsoft%20隱私權原則的詳細資訊，請參閱%20http://privacy.microsoft.com/zh-tw/default.aspx。%0\A%0\d','客戶回函');">意見反應</a>傳送給 Microsoft。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.著作權所有，並保留一切權利。</a></p></span></div></div></body></html>