<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>使用 JDBC 驅動程式</title><meta name="Language" content="zh-cht" /><meta name="System.Keywords" content="JDBC 驅動程式概觀, 使用 JDBC 驅動程式" /><meta name="Microsoft.Help.Id" content="6faaf05b-8b70-4ed2-9b44-eee5897f1cd0" /><meta name="Description" content="本節針對使用 Microsoft JDBC Driver for SQL Server 建立連至 SQL Server 資料庫的簡單連接，提供快速入門指示。連接到 SQL Server 資料庫之前，您必須先在本機電腦或伺服器上安裝 SQL Server，而且必須在本機電腦上安裝 JDBC 驅動程式。 " /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">使用 JDBC 驅動程式</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>本節針對使用 Microsoft JDBC Driver for SQL Server 建立連至 SQL Server 資料庫的簡單連接，提供快速入門指示。連接到 SQL Server 資料庫之前，您必須先在本機電腦或伺服器上安裝 SQL Server，而且必須在本機電腦上安裝 JDBC 驅動程式。 </p></div><h1 class="heading">選擇正確的 JAR 檔案</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Microsoft JDBC Driver for SQL Server 提供 <span sdata="langKeyword" value="sqljdbc.jar"><span class="keyword">sqljdbc.jar</span></span> 和 <span sdata="langKeyword" value="sqljdbc4.jar"><span class="keyword">sqljdbc4.jar</span></span> 類別庫檔案，可根據您慣用的 Java Runtime Environment (JRE) 設定使用。如需有關應該選擇哪個 JAR 檔案的詳細資訊，請參閱＜<span sdata="link"><a href="447792bb-f39b-49b4-9fd0-1ef4154c74ab.htm">JDBC 驅動程式的系統需求</a></span>＞。</p></div><h1 class="heading">設定 Classpath</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>JDBC Driver 不屬於 Java SDK 的一部分。因此，如果您想要使用它，就必須將 Classpath 設定為包含 sqljdbc.jar 檔案或 sqljdbc4.jar 檔案。如果 Classpath 遺漏 sqljdbc.jar 或 sqljdbc4.jar 的項目，您的應用程式將會擲回「找不到類別」的一般例外狀況。</p><p>sqljdbc.jar 檔案和 sqljdbc4.jar 檔案會安裝在下列位置：</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc.jar</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc4.jar</p><p>以下是用於 Windows 應用程式的 CLASSPATH 陳述式範例：</p><p><span class="code">CLASSPATH =.;C:\Program Files\Microsoft JDBC Driver 4.0 for SQL Server\sqljdbc_4.0\enu\sqljdbc.jar</span></p><p>以下是用於 Unix/Linux 應用程式的 CLASSPATH 陳述式範例：</p><p><span class="code">CLASSPATH =.:/home/usr1/mssqlserverjdbc/Driver/sqljdbc_4.0/enu/sqljdbc.jar</span></p><p>您必須確定 CLASSPATH 陳述式僅包含單一 Microsoft JDBC Driver for SQL Server，例如 sqljdbc.jar 或 sqljdbc4.jar。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>在 Windows 系統上，目錄名稱的長度超過 8.3 或資料夾名稱含有空格，都可能會造成 Classpath 的問題。如果您懷疑有這類問題，應暫時將 sqljdbc.jar 檔案或 sqljdbc4.jar 檔案移到簡單的目錄名稱下 (例如<span class="code"> C:\Temp</span>)、變更 Classpath，然後判斷這樣是否有解決問題。</p></div><h1 class="heading">直接在命令提示字元下執行的應用程式</h1><div class="subsection"><p>Classpath 是設定在作業系統中。請將 sqljdbc.jar 或 sqljdbc4.jar 附加至系統的 Classpath。另外，您也可以在執行應用程式的 Java 命令列上，使用 <span class="code"> java -classpath </span> 選項來指定 Classpath。</p></div><h1 class="heading">在 IDE 中執行的應用程式</h1><div class="subsection"><p>每一個 IDE 供應商都會提供不同的方法，在其 IDE 中設定 Classpath。只在作業系統中設定 Classpath 將無法作用。您必須將 sqljdbc.jar 或 sqljdbc4.jar 加入至 IDE Classpath。</p></div><h1 class="heading">Servlet 及 JSP</h1><div class="subsection"><p>Servlet 和 JSP 是在 servlet/JSP 引擎中執行，例如 Tomcat。Classpath 必須根據 servlet/JSP 引擎文件來設定。只在作業系統中設定 Classpath 將無法作用。有些 servlet/JSP 引擎提供設定畫面，您可以用來設定引擎的 Classpath。在此情況下，您必須將正確的 JDBC 驅動程式 JAR 檔附加到現有的引擎 Classpath 中，並重新啟動引擎。在其他情況下，您可以在引擎安裝期間，將 sqljdbc.jar 或 sqljdbc4.jar 複製到特定目錄 (例如 lib) 來部署該驅動程式。引擎驅動程式 Classpath 也可以指定在引擎特定組態檔中。</p></div><h1 class="heading">Enterprise Java Bean</h1><div class="subsection"><p>Enterprise Java Bean (EJB) 是在 EJB 容器中執行。EJB 容器的來源是各種供應商。Java Applet 會在瀏覽器中執行，但是您可以從 Web 伺服器下載。請將 sqljdbc.jar 或 sqljdbc4.jar 複製到 Web 伺服器根目錄，並在 Applet 的 HTML 保存檔索引標籤中指定 JAR 檔的名稱，例如 <span class="code">&lt;applet ... archive=sqljdbc.jar&gt;</span>。</p></div></div><h1 class="heading">與資料庫建立簡單連接</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>使用 sqljdbc.jar 類別庫時，應用程式必須先依照下列方式註冊此驅動程式：</p><p><span class="code">Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");</span></p><p>載入驅動程式之後，您就可以使用連接 URL 和 <b>DriverManager</b> 類別的 <b>getConnection</b> 方法來建立連接：</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = "jdbc:sqlserver://localhost:1433;" +
   "databaseName=AdventureWorks;user=MyUserName;password=*****;";
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>在 JDBC API 4.0 中，<b>DriverManager.getConnection</b> 方法已強化成可自動載入 JDBC 驅動程式。因此，使用 sqljdbc4.jar 類別庫時，應用程式不需要呼叫 <b>Class.forName</b> 方法來註冊或載入此驅動程式。</p><p>呼叫 <b>DriverManager</b> 類別的 <b>getConnection</b> 方法時，系統會從已註冊的 JDBC 驅動程式 集合中找出適當的驅動程式。sqljdbc4.jar 檔案包含 "META-INF/services/java.sql.Driver" 檔案，而後者又包含 <span sdata="langKeyword" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"><span class="keyword">com.microsoft.sqlserver.jdbc.SQLServerDriver</span></span> 做為已註冊的驅動程式。目前使用 <b>Class.forName</b> 方法來載入驅動程式的現有應用程式將繼續運作而不進行修改。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>sqljdbc4.jar 類別庫需要使用 Java Runtime Environment (JRE) 6.0 版或更新版本。</p></div><p>如需有關如何連接資料來源及使用連接 URL 的詳細資訊，請參閱＜<span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">建立連接 URL</a></span>＞和＜<span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">設定連接屬性</a></span>＞。</p></div><span id="seeAlsoSpan"><h1 class="heading">請參閱</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="939a8773-2583-49a4-bf00-6b892fbe39dc.htm">JDBC Driver 概觀</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">將有關本主題的<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\d感謝您的意見反應。開發人員撰寫小組會使用您的意見反應改善文件集。檢閱意見反應的同時，我們可能會傳送電子郵件給您要求提供進一步說明或是解決方案的意見。電子郵件地址不會用於任何其他目的，檢閱後將會刪除。%0\A如需有關%20Microsoft%20隱私權原則的詳細資訊，請參閱%20http://privacy.microsoft.com/zh-tw/default.aspx。%0\A%0\d','客戶回函');">意見反應</a>傳送給 Microsoft。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.著作權所有，並保留一切權利。</a></p></span></div></div></body></html>