<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>使用 SQL 逸出序列</title><meta name="Language" content="zh-cht" /><meta name="System.Keywords" content="SQL 逸出序列" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="Microsoft JDBC Driver for SQL Server 支援使用 SQL 逸出序列，如 JDBC API 所定義。逸出序列用於 SQL 陳述式，以告知驅動程式 SQL 字串的逸出部分應以不同的方式處理。當 JDBC 驅動程式處理 SQL 字串的逸出部分時，它會將該部分的字串轉譯為 SQL Server 了解的 SQL 程式碼。" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">使用 SQL 逸出序列</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Microsoft JDBC Driver for SQL Server 支援使用 SQL 逸出序列，如 JDBC API 所定義。逸出序列用於 SQL 陳述式，以告知驅動程式 SQL 字串的逸出部分應以不同的方式處理。當 JDBC 驅動程式處理 SQL 字串的逸出部分時，它會將該部分的字串轉譯為 SQL Server 了解的 SQL 程式碼。</p><p>JDBC API 需要的逸出序列有五種，而且這五種都受到 JDBC 驅動程式的支援：</p><ul><li><p>LIKE 萬用字元常值</p></li><li><p>函數處理</p></li><li><p>日期和時間常值</p></li><li><p>預存程序呼叫</p></li><li><p>外部聯結</p></li></ul><p>JDBC 驅動程式所使用的逸出序列語法如下：</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>JDBC 驅動程式的 SQL 逸出處理永遠保持開啟狀態。</p></div><p>下列幾節描述五種逸出序列，以及它們如何受到 JDBC 驅動程式支援。</p></div><h1 class="heading">LIKE 萬用字元常值</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>JDBC 驅動程式支援使用 LIKE 子句萬用字元當做常值的 <span class="code">{escape 'escape character'}</span> 語法。例如，下列程式碼將會傳回 col3 的值，其中 col2 的值會實際以底線開頭 (而非其萬用字元用法)。</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>逸出序列必須位於 SQL 陳述式結尾。對於命令字串中的多個 SQL 陳述式，則逸出序列必須位於每個相關 SQL 陳述式的結尾。</p></div></div><h1 class="heading">函數處理</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>JDBC 驅動程式在 SQL 陳述式中支援函數逸出序列，其語法如下：</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p>其中 <span class="code">functionName</span> 是 JDBC 驅動程式支援的函數。例如：</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>下表列出使用函數逸出序列時，JDBC 驅動程式支援的各種函數：</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>字串函數</p></th><th><p>數值函數</p></th><th><p>日期時間函數</p></th><th><p>系統函數</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCAT</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>LEFT</p><p>LENGTH</p><p>LOCATE</p><p>LTRIM</p><p>REPEAT</p><p>REPLACE</p><p>RIGHT</p><p>RTRIM</p><p>SOUNDEX</p><p>SPACE</p><p>SUBSTRING</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>MOD</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ROUND</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>DAYOFWEEK</p><p>DAYOFYEAR</p><p>EXTRACT</p><p>HOUR</p><p>MINUTE</p><p>MONTH</p><p>MONTHNAME</p><p>NOW</p><p>QUARTER</p><p>SECOND</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>WEEK</p><p>YEAR</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>如果您嘗試使用資料庫不支援的函數，將會發生錯誤。</p></div></div><h1 class="heading">日期和時間常值</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>日期、時間和時間戳記常值的逸出語法如下：</p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>其中 <span class="code">literal-type</span> 是下列其中之一：</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>常值類型</p></th><th><p>描述</p></th><th><p>值格式</p></th></tr><tr><td><p>d</p></td><td><p>日期</p></td><td><p>yyyy-mm-dd</p></td></tr><tr><td><p>t</p></td><td><p>時間</p></td><td><p>hh:mm:ss [1]</p></td></tr><tr><td><p>ts</p></td><td><p>時間戳記</p></td><td><p>yyyy-mm-dd hh:mm:ss[.f...]</p></td></tr></table></div><p>例如：</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">預存程序呼叫</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>JDBC 驅動程式支援預存程序呼叫的 <span class="code">{? = call proc_name(?,...)}</span> 和 <span class="code">{call proc_name(?,...)}</span> 逸出語法，視您是否需要處理傳回參數而定。</p><p>程序是一種儲存在資料庫中的可執行物件。通常，它是先行編譯的一或多個 SQL 陳述式。呼叫預存程序的逸出序列語法如下：</p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p>其中的 <span class="code">procedure-name</span> 指定預存程序的名稱，而 <span class="code">parameter</span> 則指定預存程序參數。</p><p>如需搭配預存程序使用 <span class="code">call</span> 逸出序列的詳細資訊，請參閱＜<span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">搭配預存程序使用陳述式</a></span>＞。</p></div><h1 class="heading">外部聯結</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>JDBC 驅動程式支援 SQL92 左方外部聯結、右方外部聯結和完整外部聯結語法。外部聯結的逸出序列如下：</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>其中 outer-join 為：</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p>其中 <span class="code">table-reference</span> 為資料表名稱，而 <span class="code">search-condition</span> 為您要用於資料表的聯結條件。</p><p>例如：</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>JDBC 驅動程式支援下列外部聯結逸出序列：</p><ul><li><p>左方外部聯結</p></li><li><p>右方外部聯結</p></li><li><p>完整外部聯結</p></li><li><p>巢狀外部聯結</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">請參閱</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">搭配 JDBC Driver 使用陳述式</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">將有關本主題的<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\d感謝您的意見反應。開發人員撰寫小組會使用您的意見反應改善文件集。檢閱意見反應的同時，我們可能會傳送電子郵件給您要求提供進一步說明或是解決方案的意見。電子郵件地址不會用於任何其他目的，檢閱後將會刪除。%0\A如需有關%20Microsoft%20隱私權原則的詳細資訊，請參閱%20http://privacy.microsoft.com/zh-tw/default.aspx。%0\A%0\d','客戶回函');">意見反應</a>傳送給 Microsoft。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.著作權所有，並保留一切權利。</a></p></span></div></div></body></html>